
{% from 'macros.html' import galidsearch, login %}


<!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent.
We use it to show a banner if the used browser does not play well with Marvin.-->
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
    if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1) {
        window.cookieconsent.initialise({
          "palette": {
            "popup": {
              "background": "#000"
            },
            "button": {
              "background": "#f1d600"
            }
          },
          "position": "top",
          "cookie": {
              "expiryDays": 1},
        "content": {
              "message": 'We have detected that you are using Safari. Some features may not work as expected. We recommend using Chrome or Firefox.',
              "dismiss": 'Got it!',
              "href": 'https://api.sdss.org/doc/manga/marvin/known_issues.html#known-browser'}
        })}
    }
);
</script>

<nav class="navbar navbar-default">
    <div class="container-fluid">

        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="{{url_for('index_page.Marvin:index')}}">Marvin</a>
        </div>

        <div class="navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="{{'active' if active_page=='help'}}"><a target='_blank' href="https://github.com/sdss/marvin"><i class="fa fa-github fa-fw" aria-hidden="true"></i>Github</a></li>
                <li class="{{'active' if active_page=='help'}}"><a target='_blank' href="https://api.sdss.org/doc/manga/marvin/"><i class="fa fa-question-circle-o fa-fw" aria-hidden="true"></i>Help</a></li>
                <li class="{{'active' if active_page=='search'}}"><a href="{{url_for('search_page.Search:index')}}"><i class="fa fa-search fa-fw" aria-hidden="true"></i>Search</a></li>
            </ul>

            <!-- Galaxy ID Search Box-->
            {# Marvin PlateId/MaNGAId Search #}
            {{galidsearch('headform')}}

            <!-- MPL Version Selection -->
            {# MPL Version Selection #}
            <form class='navbar-form navbar-left navbar-input-group' id='mplform' role='form' method="post">
                <div id='marvinmpl' class='form-group'>
                    <select class='form-control selectpicker input-sm show-tick' id='mplselect' name='mplselect' title='Choose an MPL/DR' >
                        {% for ver in session.versions %}
                            {% if ver.name == session.currentver %}
                                <option data-subtext='{{ver.subtext}}' id='{{ver.name}}' value='{{ver.name}}' selected>{{ver.name}}</option>
                            {% else %}
                                <option data-subtext='{{ver.subtext}}' id='{{ver.name}}' value='{{ver.name}}'>{{ver.name}}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
            </form>

            <!-- Links to some Docs -->
            {# Links to Whats New and Known Issues #}
            <div class='nav navbar-nav btn-group' id='links' role='group'>
                <a class='navbar-btn btn btn-info' target='_blank' href='https://api.sdss.org/doc/manga/marvin/whats-new.html'>What's New</a>
                <a class='navbar-btn btn btn-danger' target='_blank' href='https://api.sdss.org/doc/manga/marvin/known_issues.html'>Known Issues</a>
                <a class='navbar-btn btn btn-warning' target='_blank' href='https://api.sdss.org/doc/manga/marvin/getinvolved.html'>Get Involved</a>
            </div>

            <!-- Login / User Prefs -->
            {% if not session.loginready %}
                <!-- Login -->
                {# Login #}
                <div class='navbar-login'>
                  <ul class="nav navbar-nav navbar-right">
                    <li id='login-drop' class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-sign-in fa-fw" aria-hidden="true"></i><b>Login</b> <span class="caret"></span></a>
                        <ul id="login-dp" class="dropdown-menu">
                            <li>
                                {{login()}}
                            </li>
                        </ul>
                    </li>
                  </ul>
                </div>
            {% else %}
                <!-- User Preferences -->
                {# User Preferences Post Login #}
                <div class='navbar-userprefs'>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Welcome, {{session.name}} <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="{{url_for('users_page.User:preferences')}}"><i class="fa fa-cog fa-fw" aria-hidden="true"></i> Preferences</a></li>
                                <li class="divider"></li>
                                <li><a href="#"><i class="fa fa-sign-out fa-fw" aria-hidden="true"></i> Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            {% endif %}

        </div>
    </div>
</nav>
